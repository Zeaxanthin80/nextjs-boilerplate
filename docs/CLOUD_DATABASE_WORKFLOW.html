<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Database Development Workflow - Next.js SaaS Boilerplate</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><span class="workflow-icon">â˜ï¸</span>Cloud Database Development Workflow</h1>
            <p class="description">How team members work with the shared Prisma Postgres database during development</p>
        </header>

        <nav class="nav-grid">
            <a href="README.html" class="nav-item">ğŸ“‹ Main Documentation</a>
            <a href="DATABASE_SETUP_GUIDE.html" class="nav-item">â˜ï¸ Cloud Database Setup</a>
            <a href="DATABASE_USER_SETUP.html" class="nav-item">ğŸ—„ï¸ Local Database Setup</a>
            <a href="PROJECT_LEAD_GUIDE.html" class="nav-item">ğŸ‘¥ Project Lead Guide</a>
            <a href="ENVIRONMENT_VARIABLES_GUIDE.html" class="nav-item">ğŸ”§ Environment Setup</a>
            <a href="VERCEL_WORKFLOW_GUIDE.html" class="nav-item">ğŸš€ Vercel Deployment</a>
        </nav>

        <!-- Overview -->
        <div class="content" id="overview">
            <h2>Overview</h2>
            <p>This guide explains how team members work together when using the shared Prisma Postgres cloud database. Unlike local development where each developer has their own database, with cloud database everyone shares the same database instance.</p>

            <div class="alert alert-info">
                <strong><span class="status-icon info">ğŸ’¡</span>Key Concept:</strong> With cloud database, all developers work against the same shared database. This requires coordination and best practices to avoid conflicts.
            </div>
        </div>

        <!-- Prerequisites -->
        <div class="content" id="prerequisites">
            <h2>Prerequisites</h2>
            <div class="checklist">
                <div class="checklist-item">âœ… Cloud database is set up (see <a href="DATABASE_SETUP_GUIDE.html">Cloud Database Setup Guide</a>)</div>
                <div class="checklist-item">âœ… All team members have the same <code>DATABASE_URL</code> in their <code>.env</code></div>
                <div class="checklist-item">âœ… All team members have Prisma installed and configured</div>
                <div class="checklist-item">âœ… Team communication channel established for database changes</div>
            </div>
        </div>

        <!-- Daily Development Workflow -->
        <div class="content" id="daily-workflow">
            <h2>Daily Development Workflow</h2>

            <div class="workflow-steps">
                <div class="step">
                    <span class="step-number">1</span>
                    <h4>Start Your Development Session</h4>
                    <div class="code-block">
<span class="command"># Pull latest code</span>
git pull origin main

<span class="command"># Install any new dependencies</span>
npm install

<span class="command"># Check for new migrations</span>
npx prisma migrate status
                    </div>
                </div>

                <div class="step">
                    <span class="step-number">2</span>
                    <h4>Apply Any Pending Migrations</h4>
                    <p>If there are pending migrations from other team members:</p>
                    <div class="code-block">
<span class="command">npx prisma migrate deploy</span>
                    </div>
                    <div class="alert alert-warning">
                        <strong><span class="status-icon warning">âš ï¸</span>Important:</strong> Always apply migrations before starting development to ensure your schema is up to date.
                    </div>
                </div>

                <div class="step">
                    <span class="step-number">3</span>
                    <h4>Generate Fresh Prisma Client</h4>
                    <div class="code-block">
<span class="command">npx prisma generate</span>
                    </div>
                    <p>This ensures your Prisma client matches the current database schema.</p>
                </div>

                <div class="step">
                    <span class="step-number">4</span>
                    <h4>Develop Your Features</h4>
                    <ul>
                        <li>Work on your assigned features/tasks</li>
                        <li>Use test data with unique identifiers (e.g., include your name/initials)</li>
                        <li>Be mindful that others can see your test data</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Schema Changes -->
        <div class="content" id="schema-changes">
            <h2>Making Schema Changes</h2>

            <div class="alert alert-warning">
                <strong><span class="status-icon warning">âš ï¸</span>Critical:</strong> Schema changes affect the entire team. Always coordinate with your team before making schema changes.
            </div>

            <div class="workflow-steps">
                <div class="step">
                    <span class="step-number">1</span>
                    <h4>Announce Your Schema Changes</h4>
                    <p>Before making changes, notify your team:</p>
                    <ul>
                        <li>Post in your team communication channel</li>
                        <li>Describe what you're changing and why</li>
                        <li>Give teammates time to finish their current work</li>
                    </ul>
                    <div class="code-example">
                        <strong>Example Message:</strong><br>
                        "ğŸš¨ Schema Change: Adding 'subscription' table for billing features. Making changes in 15 minutes - please commit/stash your work!"
                    </div>
                </div>

                <div class="step">
                    <span class="step-number">2</span>
                    <h4>Update schema.prisma</h4>
                    <p>Make your changes to <code>prisma/schema.prisma</code></p>
                    <div class="code-block">
model User {
  id    String @id @default(cuid())
  email String @unique
  name  String?
  // New field
  subscription Subscription?
}

// New model
model Subscription {
  id     String @id @default(cuid())
  userId String @unique
  plan   String
  user   User   @relation(fields: [userId], references: [id])
}
                    </div>
                </div>

                <div class="step">
                    <span class="step-number">3</span>
                    <h4>Create and Apply Migration</h4>
                    <div class="code-block">
<span class="command">npx prisma migrate dev --name add_subscription_model</span>
                    </div>
                    <p>This will:</p>
                    <ul>
                        <li>Create a new migration file</li>
                        <li>Apply it to the cloud database immediately</li>
                        <li>Update your Prisma client</li>
                    </ul>
                </div>

                <div class="step">
                    <span class="step-number">4</span>
                    <h4>Test Your Changes</h4>
                    <div class="code-block">
<span class="command"># Verify schema is applied</span>
npx prisma studio

<span class="command"># Test your application</span>
npm run dev
                    </div>
                </div>

                <div class="step">
                    <span class="step-number">5</span>
                    <h4>Commit and Push</h4>
                    <div class="code-block">
<span class="command">git add .</span>
<span class="command">git commit -m "Add subscription model and migration"</span>
<span class="command">git push origin your-branch</span>
                    </div>
                </div>

                <div class="step">
                    <span class="step-number">6</span>
                    <h4>Notify Team</h4>
                    <p>Let your team know the changes are complete:</p>
                    <div class="code-example">
                        <strong>Example Message:</strong><br>
                        "âœ… Schema changes complete! Please pull latest code and run:<br>
                        <code>npx prisma migrate deploy && npx prisma generate</code>"
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Management -->
        <div class="content" id="data-management">
            <h2>Data Management Best Practices</h2>

            <div class="workflow-steps">
                <div class="step">
                    <span class="step-number">1</span>
                    <h4>Use Identifiable Test Data</h4>
                    <p>Since everyone shares the same database, make your test data identifiable:</p>
                    <div class="code-block">
// Good: Identifiable test data
const testUser = await prisma.user.create({
  data: {
    email: 'john.test@example.com',
    name: 'John Test User'
  }
});

// Bad: Generic test data
const testUser = await prisma.user.create({
  data: {
    email: 'test@example.com',
    name: 'Test User'
  }
});
                    </div>
                </div>

                <div class="step">
                    <span class="step-number">2</span>
                    <h4>Clean Up Your Test Data</h4>
                    <p>Periodically clean up your test data to keep the database tidy:</p>
                    <div class="code-block">
<span class="command"># Delete your test data</span>
await prisma.user.deleteMany({
  where: {
    email: {
      contains: 'john.test'
    }
  }
});
                    </div>
                </div>

                <div class="step">
                    <span class="step-number">3</span>
                    <h4>Use Prisma Studio for Data Inspection</h4>
                    <div class="code-block">
<span class="command">npx prisma studio</span>
                    </div>
                    <p>Browse and manage data visually at <code>http://localhost:5555</code></p>
                </div>

                <div class="step">
                    <span class="step-number">4</span>
                    <h4>Coordinate Data Resets</h4>
                    <p>If you need to reset all data, coordinate with your team first:</p>
                    <div class="alert alert-danger">
                        <strong><span class="status-icon error">ğŸš¨</span>Danger:</strong> This will delete ALL data in the shared database!
                    </div>
                    <div class="code-block">
<span class="command"># Only run after team agreement!</span>
npx prisma migrate reset --force
                    </div>
                </div>
            </div>
        </div>

        <!-- Troubleshooting -->
        <div class="content" id="troubleshooting">
            <h2>Troubleshooting Common Issues</h2>

            <div class="faq">
                <div class="faq-item">
                    <h4><span class="status-icon error">âŒ</span>Schema Drift Detected</h4>
                    <p><strong>Error:</strong> "Drift detected: Your database schema is not in sync with your migration history."</p>
                    <p><strong>Solution:</strong></p>
                    <div class="code-block">
<span class="command"># Check migration status</span>
npx prisma migrate status

<span class="command"># Apply pending migrations</span>
npx prisma migrate deploy

<span class="command"># If issues persist, reset (coordinate with team first!)</span>
npx prisma migrate reset --force
                    </div>
                </div>

                <div class="faq-item">
                    <h4><span class="status-icon error">âŒ</span>Migration Conflicts</h4>
                    <p><strong>Problem:</strong> Two developers created migrations with the same timestamp or conflicting changes.</p>
                    <p><strong>Solution:</strong></p>
                    <ol>
                        <li>Coordinate with your team to determine which migration should be kept</li>
                        <li>Delete conflicting migration files</li>
                        <li>Create a new migration that resolves the conflict</li>
                        <li>Apply the resolution migration</li>
                    </ol>
                </div>

                <div class="faq-item">
                    <h4><span class="status-icon error">âŒ</span>Prisma Client Out of Sync</h4>
                    <p><strong>Error:</strong> "The current database provider doesn't match the one specified in your schema"</p>
                    <p><strong>Solution:</strong></p>
                    <div class="code-block">
<span class="command"># Regenerate Prisma client</span>
npx prisma generate

<span class="command"># If that doesn't work, force reinstall</span>
rm -rf node_modules/.prisma
npm install
npx prisma generate
                    </div>
                </div>

                <div class="faq-item">
                    <h4><span class="status-icon warning">âš ï¸</span>Database Connection Issues</h4>
                    <p><strong>Problem:</strong> Can't connect to the cloud database.</p>
                    <p><strong>Solution:</strong></p>
                    <ol>
                        <li>Check your <code>DATABASE_URL</code> in <code>.env</code></li>
                        <li>Verify the database is still active in Prisma Console</li>
                        <li>Test connection with: <code>npx prisma db pull</code></li>
                        <li>Contact the project lead if the database URL has changed</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Team Communication -->
        <div class="content" id="team-communication">
            <h2>Team Communication Guidelines</h2>

            <div class="workflow-steps">
                <div class="step">
                    <span class="step-number">1</span>
                    <h4>Before Schema Changes</h4>
                    <ul>
                        <li>ğŸ“¢ Announce in team channel</li>
                        <li>â° Give advance notice (15-30 minutes)</li>
                        <li>ğŸ“ Describe what's changing</li>
                        <li>ğŸ”„ Wait for team confirmation</li>
                    </ul>
                </div>

                <div class="step">
                    <span class="step-number">2</span>
                    <h4>After Schema Changes</h4>
                    <ul>
                        <li>âœ… Confirm changes are complete</li>
                        <li>ğŸ“‹ Share update commands</li>
                        <li>ğŸ” Monitor for any issues</li>
                        <li>ğŸ†˜ Be available to help teammates</li>
                    </ul>
                </div>

                <div class="step">
                    <span class="step-number">3</span>
                    <h4>Regular Coordination</h4>
                    <ul>
                        <li>ğŸ“… Daily standup: Mention any planned schema changes</li>
                        <li>ğŸ—“ï¸ Weekly: Review and clean up test data</li>
                        <li>ğŸ“Š Monthly: Review database performance and optimization</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Quick Reference -->
        <div class="content" id="quick-reference">
            <h2>Quick Reference Commands</h2>

            <div class="command-grid">
                <div class="command-card">
                    <h4>Daily Startup</h4>
                    <div class="code-block">
<span class="command">git pull origin main</span>
<span class="command">npm install</span>
<span class="command">npx prisma migrate deploy</span>
<span class="command">npx prisma generate</span>
                    </div>
                </div>

                <div class="command-card">
                    <h4>Schema Changes</h4>
                    <div class="code-block">
<span class="command"># Edit schema.prisma first</span>
<span class="command">npx prisma migrate dev --name "description"</span>
<span class="command">git add .</span>
<span class="command">git commit -m "Add migration"</span>
<span class="command">git push</span>
                    </div>
                </div>

                <div class="command-card">
                    <h4>Data Management</h4>
                    <div class="code-block">
<span class="command">npx prisma studio</span>
<span class="command">npx prisma db pull</span>
<span class="command">npx prisma migrate status</span>
<span class="command">npx prisma migrate reset --force</span>
                    </div>
                </div>

                <div class="command-card">
                    <h4>Troubleshooting</h4>
                    <div class="code-block">
<span class="command">npx prisma validate</span>
<span class="command">npx prisma format</span>
<span class="command">npx prisma generate --force</span>
<span class="command">rm -rf node_modules/.prisma && npm install</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Success Checklist -->
        <div class="content" id="success-checklist">
            <h2>Team Success Checklist</h2>
            
            <div class="alert alert-success">
                <h3><span class="status-icon check">âœ…</span>Your team is successfully using cloud database when:</h3>
                <div class="checklist">
                    <div class="checklist-item">âœ… All team members can connect to the shared database</div>
                    <div class="checklist-item">âœ… Schema changes are coordinated and communicated</div>
                    <div class="checklist-item">âœ… Everyone uses identifiable test data</div>
                    <div class="checklist-item">âœ… Migration conflicts are rare and quickly resolved</div>
                    <div class="checklist-item">âœ… The database stays clean and performant</div>
                    <div class="checklist-item">âœ… Team members help each other with database issues</div>
                </div>
            </div>
        </div>

        <footer>
            <div class="footer-links">
                <a href="README.html">ğŸ“‹ Documentation Home</a>
                <a href="DATABASE_SETUP_GUIDE.html">â˜ï¸ Cloud Database Setup</a>
                <a href="DATABASE_USER_SETUP.html">ğŸ—„ï¸ Local Database Setup</a>
                <a href="PROJECT_LEAD_GUIDE.html">ğŸ‘¥ Project Lead Guide</a>
            </div>
            <p>Next.js SaaS Boilerplate Documentation</p>
        </footer>
    </div>
</body>
</html>
